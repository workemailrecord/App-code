<div id="preloader">
    <div class="loadingPlaceholder"></div>
</div>
<nav class="main-header navbar navbar-expand navbar-dark">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
    </ul>
    <ul class="navbar-nav ml-auto">
        <li class="nav-item">
            <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                <i class="fas fa-expand-arrows-alt"></i>
            </a>
        </li>
    </ul>
</nav>
<aside class="main-sidebar sidebar-dark-primary elevation-4">
    <div class="sidebar" style="margin-top: 0;">
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
            <div class="image">
                <img src="/images/avatar.svg" class="img-circle elevation-2" alt="User Image">
            </div>
            <div class="info">
                <a href="#" class="d-block">Admin | DigiSlay</a>
            </div>
        </div>
        <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                <li class="nav-item" data-level="1">
                    <a href="/admin/manager/index" class="nav-link">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <p>Wingo</p>
                        <span class="right badge badge-primary">Vip</span>
                    </a>
                </li>
                <li class="nav-item" data-level="2">
                    <a href="/admin/manager/5d" class="nav-link">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <p>5D</p>
                        <span class="right badge badge-danger">New</span>
                    </a>
                </li>
                <li class="nav-item" data-level="3">
                    <a href="/admin/manager/k3" class="nav-link">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <p>K3</p>
                        <span class="right badge badge-danger">New</span>
                    </a>
                </li>
                <li class="nav-item" data-level="4">
                    <a href="/admin/manager/members" class="nav-link">
                        <i class="nav-icon fa fa-user-circle"></i>
                        <p>Members</p>
                    </a>
                </li>
                <li class="nav-item" data-level="5">
                    <a href="/admin/manager/ctv" class="nav-link">
                        <i class="nav-icon fa fa-users"></i>
                        <p>Collaborator</p>
                    </a>
                </li>
                <li class="nav-item" data-level="6">
                    <a href="/admin/manager/statistical" class="nav-link">
                        <i class="nav-icon fas fa-chart-pie"></i>
                        <p>Create Collaborator</p>
                    </a>
                </li>
                <li class="nav-item" data-level="7">
                    <a href="/admin/manager/recharge" class="nav-link">
                        <i class="nav-icon fa fa-credit-card-alt"></i>
                        <p>Browse Recharge</p>
                    </a>
                </li>
                <li class="nav-item" data-level="8">
                    <a href="/admin/manager/withdraw" class="nav-link">
                        <i class="nav-icon fa fa-bank"></i>
                        <p>Browse Withdrawal</p>
                    </a>
                </li>
                <li class="nav-item" data-level="9">
                    <a href="/admin/manager/levelSetting" class="nav-link">
                        <i class="nav-icon fa fa-cogs"></i>
                        <p>Level Setting</p>
                    </a>
                </li>
                <li class="nav-item" data-level="10">
                    <a href="/admin/manager/CreatedSalaryRecord" class="nav-link">
                        <i class="nav-icon fa fa-cogs"></i>
                        <p>Created Salary</p>
                    </a>
                </li>
                <li class="nav-item" data-level="11">
                    <a href="/admin/manager/DailySalaryEligibility" class="nav-link">
                        <i class="nav-icon fa fa-cogs"></i>
                        <p>Daily Salary Eligibility</p>
                    </a>
                </li>
                <li class="nav-item" data-level="12">
                    <a href="/admin/manager/rechargeRecord" class="nav-link">
                        <i class="nav-icon fa fa-list"></i>
                        <p>Recharge (Approved)</p>
                    </a>
                </li>
                <li class="nav-item" data-level="13">
                    <a href="/admin/manager/withdrawRecord" class="nav-link">
                        <i class="nav-icon fa fa-list"></i>
                        <p>Withdrawal (Approved)</p>
                    </a>
                </li>
                <li class="nav-item" data-level="14">
                    <a href="/admin/manager/createBonus" class="nav-link">
                        <i class="nav-icon fa fa-gift"></i>
                        <p>Create Giftcode</p>
                    </a>
                </li>
                <li class="nav-item" data-level="15">
                    <a href="/admin/manager/settings" class="nav-link">
                        <i class="nav-icon fa fa-cog"></i>
                        <p>Settings</p>
                    </a>
                </li>
              <!--   <li class="nav-item">
                    <a href="/admin/manager/api" class="nav-link">
                        <i class="nav-icon fa fa-link" aria-hidden="true"></i>
                        <p>API</p>
                    </a>
                </li> -->
                <li class="nav-item">
                    <a href="/admin/manager/statistical4" class="nav-link" data-level="16">
                        <i class="nav-icon fa fa-sign-out" aria-hidden="true"></i>
                        <p>Create Agent </p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/home" class="nav-link" data-level="17">
                        <i class="nav-icon fa fa-sign-out" aria-hidden="true"></i>
                        <p>Go To Website</p>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</aside>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        let userData = null;

        const fetchUser = async () => {
            try {
                const response = await axios.get("/api/webapi/GetUserInfo");
                userData = response?.data?.data;
                console.log('User Data:', userData); // Debugging line
                updateNavItems();
            } catch (error) {
                console.log(error);
            }
        };

        const updateNavItems = () => {
            const allowedTabs = userData?.allowed_tabs?.split(',') || [];
            console.log('Allowed Tabs:', allowedTabs); // Debugging line
            const navItems = document.querySelectorAll('.nav-item');

            if (allowedTabs.length === 0 || allowedTabs[0] === "") {
                // If allowed_tabs is empty or not found, display all tabs
                navItems.forEach(item => {
                    item.style.display = '';
                });
            } else {
                navItems.forEach(item => {
                    const itemLevel = item.getAttribute('data-level');
                    console.log('Item Level:', itemLevel); // Debugging line
                    if (!allowedTabs.includes(itemLevel)) {
                        item.style.display = 'none';
                    }
                });
            }
        };

        fetchUser();
    });
</script>